---
title: "Examples & Code Samples"
description: "Complete examples and common patterns for using Flowglad SDKs"
---

## Overview

This page provides complete examples and common integration patterns for Flowglad SDKs. For full working applications, check out our [playground projects](#playground-projects).

## Playground Projects

### Supabase Auth + Next.js Example

A complete Next.js application demonstrating Flowglad integration with Supabase authentication.

**Location:** [playground/supabase-auth](https://github.com/flowglad/flowglad/tree/main/playground/supabase-auth)

**Features:**
- Next.js App Router
- Supabase authentication
- FlowgladProvider setup
- Feature-gated content
- Subscription management
- Customer billing portal
- Pricing table component

**Key Files:**
- `app/api/flowglad/[...path]/route.ts` - API route handler
- `app/layout.tsx` - FlowgladProvider setup
- `app/billing/page.tsx` - Billing management UI
- `app/account/page.tsx` - Feature access examples
- `utils/flowglad.ts` - FlowgladServer configuration

### Express Backend Example

A Node.js Express server with Flowglad integration.

**Location:** [playground/express](https://github.com/flowglad/flowglad/tree/main/playground/express)

**Features:**
- Express.js server
- Flowglad Express router
- API endpoint examples
- Session-based authentication
- Subscription webhooks

**Key Files:**
- `src/index.ts` - Main server file
- `src/routes/flowglad.ts` - Flowglad route setup
- `src/utils/flowglad.ts` - FlowgladServer configuration

## Complete Integration Examples

### Next.js with Supabase Auth

Full setup for a Next.js application with Supabase authentication:

<CodeGroup>

```ts utils/flowglad.ts
import { FlowgladServer } from '@flowglad/nextjs/server'
import { createClient } from '@/utils/supabase/server'

export const flowgladServer = new FlowgladServer({
  supabaseAuth: {
    client: createClient,
  },
})
```

```ts app/api/flowglad/[...path]/route.ts
import { flowgladServer } from '@/utils/flowglad'
import { createAppRouterRouteHandler } from '@flowglad/nextjs/server'

const { GET, POST } = createAppRouterRouteHandler({ flowgladServer })

export { GET, POST }
```

```tsx app/layout.tsx
import { FlowgladProvider } from '@flowglad/nextjs'

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <FlowgladProvider loadBilling={true}>
          {children}
        </FlowgladProvider>
      </body>
    </html>
  )
}
```

```tsx app/billing/page.tsx
'use client'

import { useBilling } from '@flowglad/nextjs'

export default function BillingPage() {
  const { currentSubscriptions, createCheckoutSession } = useBilling()

  const activeSubscription = currentSubscriptions?.[0]

  if (activeSubscription) {
    return (
      <div>
        <h1>Current Subscription</h1>
        <p>Status: {activeSubscription.status}</p>
        <p>Renews: {new Date(activeSubscription.currentPeriodEnd).toLocaleDateString()}</p>
      </div>
    )
  }

  return (
    <button
      onClick={() =>
        createCheckoutSession({
          // you can provide either priceSlug or priceId
          priceSlug: 'price_premium_monthly',
          successUrl: window.location.href,
          cancelUrl: window.location.href,
          autoRedirect: true,
        })
      }
    >
      Subscribe
    </button>
  )
}
```

</CodeGroup>

### React SPA with Node.js Backend

Setup for a React application with a separate Node.js backend:

<CodeGroup>

```tsx Frontend: App.tsx
import { FlowgladProvider } from '@flowglad/react'

export default function App() {
  const authToken = getAuthToken()
  return (
    <FlowgladProvider
      loadBilling={!!authToken}
      requestConfig={{
        headers: {
          Authorization: `Bearer ${authToken}`,
        },
      }}
    >
      <Router>
        {/* Your routes */}
      </Router>
    </FlowgladProvider>
  )
}
```

```tsx Frontend: BillingPage.tsx
import { useBilling } from '@flowglad/react'

export default function BillingPage() {
  const { checkFeatureAccess, createCheckoutSession } = useBilling()

  if (!checkFeatureAccess) {
    return <div>Loading...</div>
  }

  if (checkFeatureAccess('premium_feature')) {
    return <PremiumContent />
  }

  return <UpgradePrompt onUpgrade={handleUpgrade} />
}
```

```ts Backend: server.ts
import express from 'express'
import { FlowgladServer } from '@flowglad/server'
import { createFlowgladExpressRouter } from '@flowglad/express'

const app = express()

const flowgladServer = new FlowgladServer({
  getRequestingCustomer: async (context) => {
    const token = context?.req?.headers.authorization?.replace('Bearer ', '')
    const user = await verifyToken(token)
    
    return user ? {
      externalId: user.id,
      name: user.name,
      email: user.email,
    } : null
  },
})

app.use('/api/flowglad', createFlowgladExpressRouter({ flowgladServer }))
app.listen(3000)
```

</CodeGroup>

## Common Patterns

### Feature Gating

<CodeGroup>

```tsx React Component
import { useBilling } from '@flowglad/react'

export function FeatureGate({ 
  featureId, 
  fallback, 
  children 
}: {
  featureId: string
  fallback?: React.ReactNode
  children: React.ReactNode
}) {
  const { checkFeatureAccess } = useBilling()

  if (!checkFeatureAccess) {
    return null
  }

  if (!checkFeatureAccess(featureId)) {
    return fallback || <div>Upgrade to access this feature</div>
  }

  return <>{children}</>
}

// Usage
<FeatureGate 
  featureId="advanced_analytics"
  fallback={<UpgradePrompt />}
>
  <AdvancedAnalytics />
</FeatureGate>
```

```ts Server Middleware
import { flowgladServer } from './flowglad'

export function requireFeature(featureId: string) {
  return async (req, res, next) => {
    try {
      const billing = await flowgladServer.getBilling()
      const hasAccess = billing.checkFeatureAccess(featureId)

      if (!hasAccess) {
        return res.status(403).json({
          error: 'Feature not available',
          upgradeUrl: '/pricing',
        })
      }

      next()
    } catch (error) {
      next(error)
    }
  }
}

// Usage
app.get('/api/premium-data', requireFeature('premium_feature'), (req, res) => {
  res.json({ data: 'premium data' })
})
```

</CodeGroup>

### Usage Metering

```ts
import { flowgladServer } from './flowglad'

export async function trackAPICall(
  endpoint: string,
  quantity: number = 1
) {
  await flowgladServer.createUsageEvent({
    featureId: 'api_calls',
    quantity,
    usageDate: new Date().toISOString(),
    metadata: {
      endpoint,
      timestamp: Date.now().toString(),
    },
  })
}

// Usage in API routes
app.get('/api/data', async (req, res) => {
  await trackAPICall('/api/data')
  
  const data = await fetchData()
  res.json(data)
})
```

### Subscription Management

<CodeGroup>

```tsx Upgrade Button
import { useBilling } from '@flowglad/react'
import { useState } from 'react'

export function UpgradeButton({ priceId }: { priceId: string }) {
  const { createCheckoutSession } = useBilling()
  const [isLoading, setIsLoading] = useState(false)

  const handleUpgrade = async () => {
    setIsLoading(true)
    try {
      await createCheckoutSession({
        priceId,
        successUrl: `${window.location.origin}/billing/success`,
        cancelUrl: window.location.href,
        autoRedirect: true,
      })
    } catch (error) {
      console.error('Upgrade failed:', error)
      setIsLoading(false)
    }
  }

  return (
    <button onClick={handleUpgrade} disabled={isLoading}>
      {isLoading ? 'Loading...' : 'Upgrade'}
    </button>
  )
}
```

```tsx Cancel Subscription
import { useBilling } from '@flowglad/react'

export function CancelSubscriptionButton({ subscriptionId }: { subscriptionId: string }) {
  const { cancelSubscription } = useBilling()
  const [isLoading, setIsLoading] = useState(false)

  const handleCancel = async () => {
    if (!confirm('Are you sure you want to cancel?')) {
      return
    }

    setIsLoading(true)
    try {
      await cancelSubscription(subscriptionId)
      alert('Subscription canceled successfully')
    } catch (error) {
      console.error('Cancelation failed:', error)
    } finally {
      setIsLoading(false)
    }
  }

  return (
    <button onClick={handleCancel} disabled={isLoading}>
      {isLoading ? 'Processing...' : 'Cancel Subscription'}
    </button>
  )
}
```

</CodeGroup>

### Pricing Table

```tsx
import { useBilling } from '@flowglad/react'

interface Plan {
  id: string
  name: string
  priceId: string
  price: number
  features: string[]
}

const plans: Plan[] = [
  {
    id: 'basic',
    name: 'Basic',
    priceId: 'price_basic',
    price: 9.99,
    features: ['Feature 1', 'Feature 2'],
  },
  {
    id: 'premium',
    name: 'Premium',
    priceId: 'price_premium',
    price: 29.99,
    features: ['All Basic features', 'Feature 3', 'Feature 4'],
  },
]

export function PricingTable() {
  const { subscriptions, createCheckoutSession } = useBilling()

  const currentPlan = subscriptions?.find(s => s.status === 'active')

  const handleSelectPlan = async (priceId: string) => {
    await createCheckoutSession({
      priceId,
      successUrl: `${window.location.origin}/billing/success`,
      cancelUrl: window.location.href,
      autoRedirect: true,
    })
  }

  return (
    <div className="grid grid-cols-2 gap-4">
      {plans.map((plan) => (
        <div key={plan.id} className="border rounded-lg p-6">
          <h3>{plan.name}</h3>
          <p className="text-2xl font-bold">${plan.price}/mo</p>
          
          <ul>
            {plan.features.map((feature) => (
              <li key={feature}>{feature}</li>
            ))}
          </ul>

          <button
            onClick={() => handleSelectPlan(plan.priceId)}
            disabled={currentPlan?.priceId === plan.priceId}
          >
            {currentPlan?.priceId === plan.priceId ? 'Current Plan' : 'Select Plan'}
          </button>
        </div>
      ))}
    </div>
  )
}
```

### Customer Portal

```tsx
import { useBilling } from '@flowglad/react'

export function CustomerPortal() {
  const { customer, subscriptions, paymentMethods, invoices } = useBilling()

  if (!customer) {
    return <div>Loading...</div>
  }

  return (
    <div>
      <section>
        <h2>Account Information</h2>
        <p>Name: {customer.name}</p>
        <p>Email: {customer.email}</p>
      </section>

      <section>
        <h2>Subscriptions</h2>
        {subscriptions?.map((sub) => (
          <div key={sub.id}>
            <p>Status: {sub.status}</p>
            <p>Renews: {new Date(sub.currentPeriodEnd).toLocaleDateString()}</p>
          </div>
        ))}
      </section>

      <section>
        <h2>Payment Methods</h2>
        {paymentMethods?.map((pm) => (
          <div key={pm.id}>
            <p>{pm.card?.brand} •••• {pm.card?.last4}</p>
            {pm.isDefault && <span>Default</span>}
          </div>
        ))}
      </section>

      <section>
        <h2>Recent Invoices</h2>
        {invoices?.slice(0, 5).map((invoice) => (
          <div key={invoice.id}>
            <p>{new Date(invoice.createdAt).toLocaleDateString()}</p>
            <p>${(invoice.amount / 100).toFixed(2)}</p>
            <p>{invoice.status}</p>
          </div>
        ))}
      </section>
    </div>
  )
}
```

## Testing Examples

### Mock Billing Context

```tsx
import { FlowgladProvider } from '@flowglad/react'

const mockBillingData = {
  customer: {
    id: 'cus_test',
    externalId: 'user_123',
    name: 'Test User',
    email: 'test@example.com',
  },
  subscriptions: [
    {
      id: 'sub_test',
      status: 'active',
      priceId: 'price_premium',
    },
  ],
}

export function TestWrapper({ children }) {
  return (
    <FlowgladProvider
      loadBilling={false}
      initialData={mockBillingData}
    >
      {children}
    </FlowgladProvider>
  )
}
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Next.js SDK" icon="react" href="/sdks/nextjs">
    Get started with Next.js
  </Card>
  <Card title="Server SDK" icon="server" href="/sdks/server">
    Explore server capabilities
  </Card>
  <Card title="Quickstart" icon="rocket" href="/quickstart">
    Follow the quickstart guide
  </Card>
  <Card title="API Reference" icon="book" href="/api-reference/introduction">
    Browse the API documentation
  </Card>
</CardGroup>

