CREATE TYPE "public"."MembershipRole" AS ENUM('owner', 'member');--> statement-breakpoint
ALTER TABLE "memberships" ADD COLUMN "role" "MembershipRole" DEFAULT 'member' NOT NULL;--> statement-breakpoint
ALTER TABLE "memberships" ADD COLUMN "deactivated_at" integer;--> statement-breakpoint
ALTER POLICY "Enable read for own organizations where focused is true" ON "memberships" TO merchant USING ("user_id" = requesting_user_id() AND "organization_id" = current_organization_id() AND (current_auth_type() = 'api_key' OR "focused" = true) AND "deactivated_at" IS NULL);--> statement-breakpoint
ALTER POLICY "Enable update for own membership in current organization" ON "memberships" TO merchant USING ("user_id" = requesting_user_id() AND "organization_id" = current_organization_id() AND "deactivated_at" IS NULL) WITH CHECK ("user_id" = requesting_user_id() AND "organization_id" = current_organization_id());