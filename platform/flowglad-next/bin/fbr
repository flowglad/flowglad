#!/usr/bin/env zsh
# fbr - Flowglad Bun Run
# A wrapper for 'bun run' with environment selection
#
# Usage: fbr <script> [environment]
#   script      - Any script from package.json
#   environment - Optional: test, development, production (default: development)
#
# Examples:
#   fbr dev                    # NODE_ENV=development bun run dev
#   fbr migrations:push test   # NODE_ENV=test bun run migrations:push
#   fbr build production       # NODE_ENV=production bun run build

if [[ -z "$1" ]]; then
  echo "Usage: fbr <script> [environment]"
  echo "  environment: test, development, production (default: development)"
  exit 1
fi

script="$1"
env="${2:-development}"

# Validate environment
if [[ "$env" != "test" && "$env" != "development" && "$env" != "production" ]]; then
  echo "Invalid environment: $env"
  echo "Valid options: test, development, production"
  exit 1
fi

echo "Running: NODE_ENV=$env bun run $script"
NODE_ENV="$env" bun run "$script"
