# Global preload for database safety - blocks non-local DATABASE_URL in development
preload = ["./src/scripts/db-safety-preload.ts"]

[install]
autoInstall = false

[test]
# NOTE: No default preload here - each test script specifies its own preload
# to avoid conflicts between unit tests (MSW mocking) and integration tests (real APIs)
# - Unit tests: --preload ./bun.setup.ts (MSW + happy-dom)
# - Integration tests: --preload ./bun.integration.setup.ts (real Stripe/Redis)
# - RLS tests: --preload ./bun.rls.setup.ts (real DB, stub Redis)

# 5 second timeout for unit tests - forces identification of tests that need
# to be integration tests or need better mocking
timeout = 5000

# Include only .test.ts files in src/ (not .test.tsx - those run via vitest)
# Integration, flow, and RLS tests live in integration-tests/ and are run separately
include = ["src/**/*.test.ts"]
# Exclude .test.tsx files (run via vitest for frontend tests)
exclude = ["**/*.test.tsx"]
